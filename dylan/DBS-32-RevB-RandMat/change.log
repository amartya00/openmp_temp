REV B:

Added support for non-square matrices.
